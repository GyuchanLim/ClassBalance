<h1>New appointment</h1>

<%# TODO - Cleanup %>
<%# Too dirty %>

<%= form_with model: @appointment do |form| %>
  <div>
    <%= form.label :time %>
    <%= form.datetime_field :time %>
  </div>

  <div>
    <%= form.collection_select :client_1, @client_list.order(:name), :id, :name %>
    <%= form.collection_select :client_2, @client_list.order(:name), :id, :name %>
    <%= form.collection_select :client_3, @client_list.order(:name), :id, :name %>
  </div>

  <div>
    <%= form.submit %>
  </div>
<% end %>

<%= link_to "Back", appointments_path %>

<%= form_with model: @appointment do |f| %>
  <h3>Select Number of Text Fields</h3>

  <div class="number_of_client_selector":>
    <%= f.radio_button :num_fields, 1, id: "one_fields" %>
    <%= f.label :num_fields_1, '1' %>

    <%= f.radio_button :num_fields, 2, id: "two_fields" %>
    <%= f.label :num_fields_2, '2' %>

    <%= f.radio_button :num_fields, 3, id: "three_fields" %>
    <%= f.label :num_fields_3, '3' %>
  </div>

  <div id="fields_container">
    <!-- Text fields will be dynamically inserted here -->
  </div>

  <%= f.submit 'Submit' %>
<% end %>

<script>
  // Function to update the number of text fields based on selected radio button
  document.addEventListener("DOMContentLoaded", function() {
    const fieldsContainer = document.getElementById("fields_container");

    // Function to update fields based on the selected radio button
    function updateFields() {
      const radio1 = document.querySelector('#one_fields');
      const radio2 = document.querySelector('#two_fields');
      const radio3 = document.querySelector('#three_fields');

      // Add event listeners to detect changes

      function insertMessage(radioNumber) {
        const newDiv = document.createElement('div');
        newDiv.textContent = `Hello I am radio button #${radioNumber}`;
        fieldsContainer.appendChild(newDiv);
      }

      radio1.addEventListener('change', () => {
        insertMessage(1);
      });

      radio2.addEventListener('change', () => {
        insertMessage(2);
      });

      radio3.addEventListener('change', () => {
        insertMessage(3);
      });
    }

    // Event listener for radio button changes
    document.querySelectorAll('input[name="num_fields"]').forEach(function(radio) {
      radio.addEventListener('change', updateFields);
    });

    // Initialize the fields based on the current radio button selection (if any)
    updateFields();
  });
</script>

